<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cross-Exchange Arbitrage - ARB4ME</title>
    <style>
        body {
            background: linear-gradient(135deg, #0c0c1e 0%, #161632 100%);
            color: #b8c6db;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            margin: 0;
            padding: 20px;
            min-height: 100vh;
        }

        .cross-exchange-container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            color: #b8c6db;
            font-size: 0.9rem;
        }

        .form-group input {
            width: 100%;
            padding: 8px 12px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 6px;
            color: #fff;
            font-size: 0.9rem;
        }

        .toggle-switch {
            width: 50px;
            height: 25px;
            background: #ff6b6b;
            border-radius: 25px;
            position: relative;
            cursor: pointer;
            transition: all 0.3s;
        }

        .toggle-switch.active {
            background: #00ff88;
        }

        .toggle-knob {
            width: 21px;
            height: 21px;
            background: white;
            border-radius: 50%;
            position: absolute;
            top: 2px;
            left: 2px;
            transition: all 0.3s;
        }

        .toggle-switch.active .toggle-knob {
            left: 27px;
        }

        .btn {
            background: linear-gradient(45deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.9rem;
            color: #b8c6db;
        }

        /* Make tab content visible by default on this page */
        #crossExchangeTab {
            display: block !important;
            visibility: visible !important;
            opacity: 1 !important;
        }

        /* Spinner animation for test scan loading */
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="cross-exchange-container">
        <!-- Return to Dashboard Button -->
        <div style="margin-bottom: 20px; text-align: center;">
            <button onclick="returnToPlatform()" class="btn" style="background: linear-gradient(45deg, #ff6b6b 0%, #ee5a24 100%); font-size: 1rem; padding: 15px 30px;">
                ‚Üê Return to Dashboard
            </button>
        </div>

        <!-- Cross-Exchange Arbitrage Management Tab -->
        <div id="crossExchangeTab" class="tab-content active">
            <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 15px;">
                <h3 style="color: #00d4ff; margin: 0;">üí± Cross-Exchange Arbitrage Management</h3>
                <button onclick="openCrossExchangeAboutModal()" style="background: rgba(0,212,255,0.2); color: #00d4ff; border: 1px solid #00d4ff; padding: 6px 16px; border-radius: 6px; cursor: pointer; font-size: 0.85rem; font-weight: 600; transition: all 0.3s;" onmouseover="this.style.background='rgba(0,212,255,0.3)'" onmouseout="this.style.background='rgba(0,212,255,0.2)'">
                    ‚ÑπÔ∏è About
                </button>
            </div>

            <div style="margin-bottom: 20px; padding: 15px; background: rgba(0,255,136,0.1); border: 2px solid #00ff88; border-radius: 10px;">
                <div style="font-size: 1.2rem; color: #00ff88; margin-bottom: 15px; font-weight: bold; text-align: center;">
                    ‚úÖ CROSS-EXCHANGE ARB ACTIVE
                </div>
                <div style="color: #b8c6db; text-align: center;">
                    Monitor price differences across all connected exchanges and execute profitable arbitrage trades automatically.
                </div>
            </div>

            <!-- System Overview -->
            <div style="margin-bottom: 20px; padding: 15px; background: rgba(0,212,255,0.1); border-radius: 10px;">
                <h4 style="color: #00d4ff; margin-bottom: 10px;">üìä System Overview</h4>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px;">
                    <div style="padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; text-align: center;">
                        <div style="font-size: 1.5rem; color: #00ff88; font-weight: bold;" id="connectedExchanges">0</div>
                        <div style="font-size: 0.9rem; color: #b8c6db;">Connected Exchanges</div>
                    </div>
                    <div style="padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; text-align: center;">
                        <div style="font-size: 1.5rem; color: #ffb347; font-weight: bold;" id="activePairs">0</div>
                        <div style="font-size: 0.9rem; color: #b8c6db;">Active Pairs</div>
                    </div>
                    <div style="padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; text-align: center;">
                        <div style="font-size: 1.5rem; color: #ff6b6b; font-weight: bold;" id="opportunitiesToday">0</div>
                        <div style="font-size: 0.9rem; color: #b8c6db;">Opportunities Today</div>
                    </div>
                    <div style="padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; text-align: center;">
                        <div style="font-size: 1.5rem; color: #00d4ff; font-weight: bold;" id="totalProfit">$0.00</div>
                        <div style="font-size: 0.9rem; color: #b8c6db;">Total Profit</div>
                    </div>
                </div>
            </div>

            <!-- Crypto Asset Selection (moved from settings page) -->
            <div style="margin-bottom: 20px;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                    <h3 style="color: #00d4ff; margin: 0;">üíé Crypto Asset Selection</h3>
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <h3 style="color: #00ff88; margin: 0;">üîç Quick Asset Search</h3>
                        <div style="position: relative;">
                            <input type="text" id="cryptoSearchInput" placeholder="Type asset (e.g. XRP, BTC)..."
                                   style="padding: 8px 12px; background: rgba(255,255,255,0.1); border: 1px solid #00ff88; border-radius: 6px; color: white; width: 200px; font-size: 0.9rem;"
                                   autocomplete="off">
                            <div id="searchDropdown" style="position: absolute; top: 100%; left: 0; right: 0; background: rgba(30,30,30,0.95); border: 1px solid #00ff88; border-top: none; border-radius: 0 0 6px 6px; max-height: 200px; overflow-y: auto; z-index: 1000; display: none;">
                                <!-- Search results will appear here -->
                            </div>
                        </div>
                    </div>
                </div>
                <div style="margin-bottom: 20px; padding: 15px; background: rgba(0,212,255,0.1); border-radius: 10px;">
                    <div style="font-size: 0.9rem; color: #b8c6db; margin-bottom: 15px;">
                        Select which crypto pairs to monitor for arbitrage opportunities.
                    </div>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px;">
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_XRPUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">XRP/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_BTCUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">BTC/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_ETHUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">ETH/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_SOLUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">SOL/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_LINKUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">LINK/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_DOGEUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">DOGE/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_ADAUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">ADA/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_DOTUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">DOT/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_AVAXUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">AVAX/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_MATICUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">MATIC/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_LTCUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">LTC/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_ATOMUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">ATOM/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_BNBUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">BNB/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_UNIUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">UNI/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_BCHUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">BCH/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_SHIBUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">SHIB/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_ETHBTC" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">ETH/BTC</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_ADABTC" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">ADA/BTC</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_DOTETH" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">DOT/ETH</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_LINKBTC" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">LINK/BTC</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_XRPBTC" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">XRP/BTC</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_XLMBTC" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">XLM/BTC</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_ALGOBTC" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">ALGO/BTC</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_HBARBTC" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">HBAR/BTC</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_HBARUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">HBAR/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_SOLBTC" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">SOL/BTC</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_MATICBTC" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">MATIC/BTC</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_AVAXBTC" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">AVAX/BTC</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_BNBBTC" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">BNB/BTC</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_LTCBTC" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">LTC/BTC</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_SOLETH" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">SOL/ETH</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_MATICETH" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">MATIC/ETH</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_LINKETH" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">LINK/ETH</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_UNIETH" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">UNI/ETH</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_BTCUSDC" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">BTC/USDC</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_ETHUSDC" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">ETH/USDC</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_SUNUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">SUN/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_UBXSUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">UBXS/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_GMMTUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">GMMT/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_SNPTUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">SNPT/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_ONDOUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">ONDO/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_TRADEUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">TRADE/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_TLOSUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">TLOS/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_ZCXUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">ZCX/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_PINUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">PIN/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_UDSUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">UDS/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_TETUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">TET/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_OMIUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">OMI/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_HTXUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">HTX/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_BADUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">BAD/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_DNXUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">DNX/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_HASHAIUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">HASHAI/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_XTAGUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">XTAG/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_AIMONICAUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">AIMONICA/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_IAGUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">IAG/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_SEIUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">SEI/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_MASAUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">MASA/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_TRVLUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">TRVL/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_OMNIAUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">OMNIA/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_ARCAUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">ARCA/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_EVMOSUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">EVMOS/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_HEARTUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">HEART/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_XCADUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">XCAD/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_ZCDUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">ZCD/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_NAIUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">NAI/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_NPCUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">NPC/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_HAIUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">HAI/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_NTXUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">NTX/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_TURBOUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">TURBO/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_NOTUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">NOT/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_BLSUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">BLS/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_DFYNUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">DFYN/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_STRMUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">STRM/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_XPRTUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">XPRT/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_HTMUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">HTM/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_TOKOUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">TOKO/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_ATRUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">ATR/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_ATLASUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">ATLAS/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_PAWSUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">PAWS/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_KASTAUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">KASTA/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_PZPUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">PZP/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_QTLXUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">QTLX/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_SCPTUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">SCPT/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_MTRGUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">MTRG/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_VANRYUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">VANRY/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_XRPHUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">XRPH/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_ZANOUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">ZANO/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_STBUUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">STBU/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_REKTUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">REKT/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_AGLAUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">AGLA/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_PROPCUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">PROPC/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_SPARKLETUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">SPARKLET/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_CSIXUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">CSIX/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_HOODUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">HOOD/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_MBGUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">MBG/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_SEEDUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">SEED/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_MUBIUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">MUBI/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_XPUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">XP/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_SNYUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">SNY/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_PEPE2USDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">PEPE2/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_SWEATUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">SWEAT/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_KIPUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">KIP/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_VISTAUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">VISTA/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_DKSUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">DKS/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_CKBUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">CKB/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_QUBICUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">QUBIC/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_ETNUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">ETN/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_XLMUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">XLM/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_PEPEUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">PEPE/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_AAVEUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">AAVE/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_AGRIUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">AGRI/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_ALGOUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">ALGO/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_LUMENUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">LUMEN/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_SFIUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">SFI/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_PROPSUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">PROPS/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_VEMPUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">VEMP/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_XRUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">XR/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_XDCUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">XDC/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_GELUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">GEL/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_RTFUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">RTF/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_DCKUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">DCK/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_MOGUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">MOG/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_RETIKUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">RETIK/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_ARBUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">ARB/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_VSCUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">VSC/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_REDOUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">REDO/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_MEMEFIUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">MEMEFI/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_MUBUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">MUB/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_AKIUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">AKI/USDT</div>
                            </div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="asset_XZKUSDT" checked style="margin-right: 10px;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold;">XZK/USDT</div>
                            </div>
                        </label>
                    </div>
                </div>
            </div>

            <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
            <!-- TEST SCAN MODE - Simulation Only (No Real Trading) -->
            <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
            <div style="margin-bottom: 20px; padding: 20px; background: rgba(0,212,255,0.1); border: 2px solid #00d4ff; border-radius: 10px;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                    <h3 style="color: #00d4ff; margin: 0;">üî¨ Test Scan Mode (Simulation)</h3>
                    <div style="background: rgba(255,183,71,0.2); padding: 8px 15px; border-radius: 6px; border: 1px solid #ffb347;">
                        <span style="color: #ffb347; font-size: 0.9rem; font-weight: bold;">üìä PUBLIC API - NO CREDENTIALS REQUIRED</span>
                    </div>
                </div>

                <div style="background: rgba(0,0,0,0.2); padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                    <p style="color: #b8c6db; font-size: 0.95rem; margin: 0 0 10px 0;">
                        <strong style="color: #00ff88;">Test Scan Mode</strong> simulates cross-exchange arbitrage opportunities using public market data.
                        No real trades are executed - this is for analysis and strategy testing only.
                    </p>
                    <p style="color: #b8c6db; font-size: 0.9rem; margin: 0;">
                        <strong>How it works:</strong> Compares prices across all selected exchanges for each asset, calculates potential profit after fees (0.2% total), and displays top 10 opportunities.
                    </p>
                </div>

                <!-- Exchange Selection -->
                <div style="margin-bottom: 20px;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                        <h4 style="color: #00d4ff; margin: 0;">üè¶ Exchange Selection</h4>
                        <div style="display: flex; gap: 10px;">
                            <button onclick="selectAllTestScanExchanges()" style="padding: 8px 15px; background: rgba(0,255,136,0.2); border: 1px solid #00ff88; color: #00ff88; border-radius: 6px; cursor: pointer; font-size: 0.85rem; transition: all 0.3s;" onmouseover="this.style.background='rgba(0,255,136,0.3)'" onmouseout="this.style.background='rgba(0,255,136,0.2)'">
                                ‚úì Select All
                            </button>
                            <button onclick="deselectAllTestScanExchanges()" style="padding: 8px 15px; background: rgba(255,107,107,0.2); border: 1px solid #ff6b6b; color: #ff6b6b; border-radius: 6px; cursor: pointer; font-size: 0.85rem; transition: all 0.3s;" onmouseover="this.style.background='rgba(255,107,107,0.3)'" onmouseout="this.style.background='rgba(255,107,107,0.2)'">
                                ‚úó Deselect All
                            </button>
                        </div>
                    </div>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 10px;">
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" class="test-scan-exchange" value="binance" checked style="margin-right: 10px;">
                            <div style="flex: 1; font-weight: bold; color: #ffb347;">Binance</div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" class="test-scan-exchange" value="kraken" checked style="margin-right: 10px;">
                            <div style="flex: 1; font-weight: bold; color: #ffb347;">Kraken</div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" class="test-scan-exchange" value="okx" checked style="margin-right: 10px;">
                            <div style="flex: 1; font-weight: bold; color: #ffb347;">OKX</div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" class="test-scan-exchange" value="bybit" checked style="margin-right: 10px;">
                            <div style="flex: 1; font-weight: bold; color: #ffb347;">Bybit</div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" class="test-scan-exchange" value="kucoin" checked style="margin-right: 10px;">
                            <div style="flex: 1; font-weight: bold; color: #ffb347;">Kucoin</div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" class="test-scan-exchange" value="mexc" checked style="margin-right: 10px;">
                            <div style="flex: 1; font-weight: bold; color: #ffb347;">MEXC</div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" class="test-scan-exchange" value="htx" checked style="margin-right: 10px;">
                            <div style="flex: 1; font-weight: bold; color: #ffb347;">HTX</div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" class="test-scan-exchange" value="gateio" checked style="margin-right: 10px;">
                            <div style="flex: 1; font-weight: bold; color: #ffb347;">Gate.io</div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" class="test-scan-exchange" value="bitget" checked style="margin-right: 10px;">
                            <div style="flex: 1; font-weight: bold; color: #ffb347;">Bitget</div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" class="test-scan-exchange" value="valr" checked style="margin-right: 10px;">
                            <div style="flex: 1; font-weight: bold; color: #ffb347;">VALR</div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" class="test-scan-exchange" value="luno" checked style="margin-right: 10px;">
                            <div style="flex: 1; font-weight: bold; color: #ffb347;">Luno</div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" class="test-scan-exchange" value="gemini" checked style="margin-right: 10px;">
                            <div style="flex: 1; font-weight: bold; color: #ffb347;">Gemini</div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" class="test-scan-exchange" value="bitmart" checked style="margin-right: 10px;">
                            <div style="flex: 1; font-weight: bold; color: #ffb347;">Bitmart</div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" class="test-scan-exchange" value="bitrue" checked style="margin-right: 10px;">
                            <div style="flex: 1; font-weight: bold; color: #ffb347;">Bitrue</div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" class="test-scan-exchange" value="xtcom" checked style="margin-right: 10px;">
                            <div style="flex: 1; font-weight: bold; color: #ffb347;">XT.com</div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" class="test-scan-exchange" value="cryptocom" checked style="margin-right: 10px;">
                            <div style="flex: 1; font-weight: bold; color: #ffb347;">Crypto.com</div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" class="test-scan-exchange" value="chainex" checked style="margin-right: 10px;">
                            <div style="flex: 1; font-weight: bold; color: #ffb347;">Chainex</div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" class="test-scan-exchange" value="coincatch" checked style="margin-right: 10px;">
                            <div style="flex: 1; font-weight: bold; color: #ffb347;">Coincatch</div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" class="test-scan-exchange" value="bingx" checked style="margin-right: 10px;">
                            <div style="flex: 1; font-weight: bold; color: #ffb347;">BingX</div>
                        </label>
                        <label style="display: flex; align-items: center; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" class="test-scan-exchange" value="ascendex" checked style="margin-right: 10px;">
                            <div style="flex: 1; font-weight: bold; color: #ffb347;">Ascendex</div>
                        </label>
                    </div>
                </div>

                <!-- Asset Selection for Test Scan -->
                <div style="background: rgba(0,255,136,0.1); border: 1px solid #00ff88; border-radius: 8px; padding: 20px; margin-bottom: 20px;">
                    <h5 style="color: #00ff88; margin-bottom: 15px; font-size: 1rem;">üíé Asset Selection (Test Scan Only)</h5>
                    <p style="color: #888; font-size: 0.85rem; margin-bottom: 15px;">
                        Select crypto pairs to test. These selections are separate from live trading configuration. <strong style="color: #00ff88;">(130+ pairs available)</strong>
                    </p>
                    <div id="testScanAssetGrid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); gap: 6px; max-height: 400px; overflow-y: auto; padding: 10px; background: rgba(0,0,0,0.2); border-radius: 6px;">
                        <!-- Assets will be populated by JavaScript -->
                    </div>
                    <div style="margin-top: 10px; padding-top: 10px; border-top: 1px solid rgba(255,255,255,0.1);">
                        <button onclick="selectAllCrossExAssets()" style="padding: 6px 12px; background: rgba(0,255,136,0.2); border: 1px solid #00ff88; color: #00ff88; border-radius: 4px; cursor: pointer; font-size: 0.75rem; margin-right: 8px;">‚úì Select All</button>
                        <button onclick="deselectAllCrossExAssets()" style="padding: 6px 12px; background: rgba(255,107,107,0.2); border: 1px solid #ff6b6b; color: #ff6b6b; border-radius: 4px; cursor: pointer; font-size: 0.75rem;">‚úó Clear All</button>
                        <span id="testScanAssetCount" style="color: #888; font-size: 0.8rem; margin-left: 10px;">0 selected</span>
                    </div>
                </div>

                <!-- Control Buttons -->
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px;">
                    <button id="startCrossExTestScanBtn" onclick="startCrossExchangeTestScan()" style="padding: 14px; background: linear-gradient(135deg, #00ff88, #00d4ff); border: none; color: #0c0c1e; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 1rem; transition: all 0.3s; box-shadow: 0 4px 15px rgba(0,212,255,0.3);" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(0,212,255,0.5)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(0,212,255,0.3)'">
                        ‚ñ∂Ô∏è Start Test Scan
                    </button>
                    <button id="stopCrossExTestScanBtn" onclick="stopCrossExchangeTestScan()" disabled style="padding: 14px; background: rgba(255,107,107,0.5); border: none; color: rgba(255,255,255,0.5); border-radius: 8px; cursor: not-allowed; font-weight: bold; font-size: 1rem;">
                        ‚èπÔ∏è Stop Test Scan
                    </button>
                </div>

                <!-- Status Dashboard (Always Visible) -->
                <div id="crossExTestScanStatus" style="background: rgba(0,255,136,0.1); border: 1px solid #00ff88; border-radius: 8px; padding: 20px; margin-bottom: 25px;">
                    <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; margin-bottom: 15px;">
                        <div>
                            <div style="color: #888; font-size: 0.75rem; text-transform: uppercase; margin-bottom: 5px;">Status</div>
                            <div id="crossExStatusText" style="color: #888; font-weight: bold; font-size: 1.1rem;">‚ö™ READY TO SCAN</div>
                        </div>
                        <div>
                            <div style="color: #888; font-size: 0.75rem; text-transform: uppercase; margin-bottom: 5px;">Scan Cycles</div>
                            <div id="crossExScanCycles" style="color: #fff; font-weight: bold; font-size: 1.1rem;">0</div>
                        </div>
                        <div>
                            <div style="color: #888; font-size: 0.75rem; text-transform: uppercase; margin-bottom: 5px;">Data Collected</div>
                            <div id="crossExOppsFound" style="color: #ffc107; font-weight: bold; font-size: 1.1rem;">0 / 50,000</div>
                            <div id="crossExStoragePercent" style="color: #888; font-size: 0.7rem; margin-top: 2px;">0%</div>
                        </div>
                        <div>
                            <div style="color: #888; font-size: 0.75rem; text-transform: uppercase; margin-bottom: 5px;">Running Time</div>
                            <div id="crossExRunTime" style="color: #fff; font-weight: bold; font-size: 1.1rem;">0:00</div>
                        </div>
                    </div>
                    <div style="border-top: 1px solid rgba(255,255,255,0.1); padding-top: 15px;">
                        <div style="color: #888; font-size: 0.75rem; text-transform: uppercase; margin-bottom: 5px;">Current Scan</div>
                        <div id="crossExCurrentSet" style="color: #888; font-size: 0.9rem;">Click "Start Test Scan" to begin...</div>
                        <div style="margin-top: 10px; color: #888; font-size: 0.85rem;">
                            Next scan in: <span id="crossExCountdown" style="color: #00d4ff; font-weight: bold;">--</span>
                        </div>
                    </div>
                    <div style="border-top: 1px solid rgba(255,255,255,0.1); padding-top: 15px; margin-top: 15px;">
                        <div style="color: #888; font-size: 0.75rem; text-transform: uppercase; margin-bottom: 5px;">Best Opportunity Found</div>
                        <div id="crossExBestOpp" style="color: #ffc107; font-size: 0.95rem; font-weight: bold;">None yet</div>
                    </div>
                </div>

                <!-- Live Analysis Report -->
                <div id="crossExTestScanReports">
                    <h4 style="color: #ffc107; margin-bottom: 20px; font-size: 1.2rem; text-align: center;">üìä Live Analysis Report</h4>

                    <!-- Top 20 Routes by Profit % -->
                    <div style="background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; padding: 20px; margin-bottom: 20px;">
                        <h5 style="color: #00ff88; margin-bottom: 15px;">üèÜ Top 20 Routes by Profit %</h5>
                        <div style="overflow-x: auto;">
                            <table style="width: 100%; border-collapse: collapse; color: #b8c6db; font-size: 0.85rem;">
                                <thead>
                                    <tr style="border-bottom: 1px solid rgba(255,255,255,0.1);">
                                        <th style="text-align: left; padding: 10px; color: #888;">#</th>
                                        <th style="text-align: left; padding: 10px; color: #888;">Route</th>
                                        <th style="text-align: left; padding: 10px; color: #888;">Asset</th>
                                        <th style="text-align: right; padding: 10px; color: #888;">Avg Profit %</th>
                                        <th style="text-align: right; padding: 10px; color: #888;">Best Profit %</th>
                                        <th style="text-align: right; padding: 10px; color: #888;">Times Found</th>
                                        <th style="text-align: right; padding: 10px; color: #888;">Last Seen</th>
                                    </tr>
                                </thead>
                                <tbody id="crossExTopProfitBody">
                                    <tr><td colspan="7" style="text-align: center; padding: 30px; color: #888; font-style: italic;">Waiting for scan data... Click "Start Test Scan" above.</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Top 20 Routes by Consistency -->
                    <div style="background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; padding: 20px; margin-bottom: 20px;">
                        <h5 style="color: #00d4ff; margin-bottom: 15px;">üìà Top 20 Routes by Consistency (Most Reliable)</h5>
                        <div style="overflow-x: auto;">
                            <table style="width: 100%; border-collapse: collapse; color: #b8c6db; font-size: 0.85rem;">
                                <thead>
                                    <tr style="border-bottom: 1px solid rgba(255,255,255,0.1);">
                                        <th style="text-align: left; padding: 10px; color: #888;">#</th>
                                        <th style="text-align: left; padding: 10px; color: #888;">Route</th>
                                        <th style="text-align: left; padding: 10px; color: #888;">Asset</th>
                                        <th style="text-align: right; padding: 10px; color: #888;">Times Found</th>
                                        <th style="text-align: right; padding: 10px; color: #888;">Avg Profit %</th>
                                        <th style="text-align: right; padding: 10px; color: #888;">Min/Max Profit</th>
                                        <th style="text-align: center; padding: 10px; color: #888;">Consistency</th>
                                    </tr>
                                </thead>
                                <tbody id="crossExTopConsistencyBody">
                                    <tr><td colspan="7" style="text-align: center; padding: 30px; color: #888; font-style: italic;">Waiting for scan data... Click "Start Test Scan" above.</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Best Cryptos & Best Exchanges Side by Side -->
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                        <!-- Best Cryptos -->
                        <div style="background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; padding: 20px;">
                            <h5 style="color: #667eea; margin-bottom: 15px;">‚ö° Best Cryptos for Cross-Exchange Arb</h5>
                            <div style="overflow-x: auto;">
                                <table style="width: 100%; border-collapse: collapse; color: #b8c6db; font-size: 0.85rem;">
                                    <thead>
                                        <tr style="border-bottom: 1px solid rgba(255,255,255,0.1);">
                                            <th style="text-align: left; padding: 10px; color: #888;">Crypto</th>
                                            <th style="text-align: right; padding: 10px; color: #888;">Opps</th>
                                            <th style="text-align: right; padding: 10px; color: #888;">Avg Profit</th>
                                        </tr>
                                    </thead>
                                    <tbody id="crossExBestCryptosBody">
                                        <tr><td colspan="3" style="text-align: center; padding: 20px; color: #888;">Waiting for scan data...</td></tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- Best Exchanges -->
                        <div style="background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; padding: 20px;">
                            <h5 style="color: #ffb347; margin-bottom: 15px;">üè¶ Best Exchange Pairs</h5>
                            <div style="overflow-x: auto;">
                                <table style="width: 100%; border-collapse: collapse; color: #b8c6db; font-size: 0.85rem;">
                                    <thead>
                                        <tr style="border-bottom: 1px solid rgba(255,255,255,0.1);">
                                            <th style="text-align: left; padding: 10px; color: #888;">Exchange Pair</th>
                                            <th style="text-align: right; padding: 10px; color: #888;">Opps</th>
                                            <th style="text-align: right; padding: 10px; color: #888;">Avg Profit</th>
                                        </tr>
                                    </thead>
                                    <tbody id="crossExBestExchangesBody">
                                        <tr><td colspan="3" style="text-align: center; padding: 20px; color: #888;">Waiting for scan data...</td></tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- Time of Day Analysis -->
                    <div style="background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; padding: 20px;">
                        <h5 style="color: #ffc107; margin-bottom: 15px;">üïê Best Times to Trade (Hourly Analysis)</h5>
                        <div style="overflow-x: auto;">
                            <table style="width: 100%; border-collapse: collapse; color: #b8c6db; font-size: 0.85rem;">
                                <thead>
                                    <tr style="border-bottom: 1px solid rgba(255,255,255,0.1);">
                                        <th style="text-align: left; padding: 10px; color: #888;">Hour (Local Time)</th>
                                        <th style="text-align: right; padding: 10px; color: #888;">Opportunities</th>
                                        <th style="text-align: right; padding: 10px; color: #888;">Avg Profit %</th>
                                        <th style="text-align: left; padding: 10px; color: #888;">Most Common Route</th>
                                    </tr>
                                </thead>
                                <tbody id="crossExTimeAnalysisBody">
                                    <tr><td colspan="4" style="text-align: center; padding: 20px; color: #888;">Waiting for scan data...</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Trading Configuration -->
            <div style="margin-bottom: 20px; padding: 15px; background: rgba(255,107,107,0.1); border: 2px solid #ff6b6b; border-radius: 10px;">
                <h4 style="color: #ff6b6b; margin-bottom: 10px;">‚öôÔ∏è Trading Configuration</h4>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                    <!-- Risk Management -->
                    <div class="stat-card">
                        <h5 style="color: #ffb347; margin-bottom: 15px;">‚öñÔ∏è Risk Management</h5>
                        <div class="form-group">
                            <label>Max Trade Size (USDT)</label>
                            <input type="number" id="maxTradeSize" value="1000" min="100" max="100000">
                        </div>
                        <div class="form-group">
                            <label>Min Profit Threshold (%)</label>
                            <input type="number" id="minProfitThreshold" value="0.5" min="0.1" max="5" step="0.1">
                        </div>
                        <div class="form-group">
                            <label>Portfolio % to Trade</label>
                            <input type="number" id="portfolioPercentage" value="10" min="1" max="100" step="1">
                            <small style="color: #b8c6db; font-size: 0.85rem; display: block; margin-top: 5px;">
                                Max % of available balance to use per trade (e.g., 10% of 100 USDT = 10 USDT per trade)
                            </small>
                        </div>
                    </div>

                    <!-- Exchange Priority -->
                    <div class="stat-card">
                        <h5 style="color: #ffb347; margin-bottom: 15px;">üèÜ Exchange Priority</h5>
                        <p style="font-size: 0.85rem; color: #b8c6db; margin-bottom: 10px;">
                            Order of preference for arbitrage execution
                        </p>
                        <ol style="color: #b8c6db; font-size: 0.9rem; padding-left: 20px;">
                            <li>VALR ‚Üî Luno</li>
                            <li>VALR ‚Üî AltCoinTrader</li>
                            <li>Luno ‚Üî AltCoinTrader</li>
                            <li>International Exchanges</li>
                        </ol>
                    </div>

                    <!-- Performance Stats -->
                    <div class="stat-card">
                        <h5 style="color: #ffb347; margin-bottom: 15px;">üìà Performance Stats</h5>
                        <div style="display: grid; grid-template-columns: 1fr auto; gap: 10px; font-size: 0.9rem;">
                            <span style="color: #b8c6db;">Total Trades:</span>
                            <span style="color: #00ff88;" id="totalTrades">0</span>

                            <span style="color: #b8c6db;">Success Rate:</span>
                            <span style="color: #00ff88;" id="successRate">0%</span>

                            <span style="color: #b8c6db;">Avg Profit/Trade:</span>
                            <span style="color: #00ff88;" id="avgProfit">$0.00</span>

                            <span style="color: #b8c6db;">Best Trade:</span>
                            <span style="color: #00ff88;" id="bestTrade">-</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Control Buttons -->
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px;">
                <button onclick="scanForOpportunities()" class="btn">
                    üöÄ Enable Auto-Trading
                </button>
                <button onclick="viewTradeHistory()" class="btn">
                    üìä Trade History
                </button>
                <button onclick="configureExchanges()" class="btn">
                    ‚öôÔ∏è Configure Exchanges
                </button>
                <button onclick="exportData()" class="btn">
                    üì• Export Data
                </button>
            </div>

            <!-- Recent Trades -->
            <div style="background: rgba(0,0,0,0.3); padding: 15px; border-radius: 10px;">
                <h4 style="color: #ffb347; margin-bottom: 15px;">üïí Recent Cross-Exchange Trades</h4>
                <div id="recentTrades" style="max-height: 200px; overflow-y: auto;">
                    <div style="text-align: center; color: #888; padding: 20px;">
                        No cross-exchange trades yet. Connect exchanges and enable trading to start.
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Cross-Exchange Arbitrage About Modal -->
    <div id="crossExchangeAboutModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 10000; justify-content: center; align-items: center;">
        <div style="background: linear-gradient(135deg, #0c0c1e 0%, #161632 100%); padding: 30px; border-radius: 15px; max-width: 600px; width: 90%; max-height: 90vh; border: 2px solid #00d4ff; box-shadow: 0 10px 40px rgba(0,212,255,0.3); position: relative; overflow-y: auto;">
            <!-- Close Button -->
            <button onclick="closeCrossExchangeAboutModal()" style="position: absolute; top: 15px; right: 15px; background: rgba(255,68,68,0.9); border: none; color: #fff; width: 35px; height: 35px; border-radius: 50%; cursor: pointer; font-size: 1.5rem; font-weight: bold; display: flex; align-items: center; justify-content: center; transition: all 0.3s; z-index: 1;" onmouseover="this.style.background='rgba(255,68,68,1)'; this.style.transform='scale(1.1)'" onmouseout="this.style.background='rgba(255,68,68,0.9)'; this.style.transform='scale(1)'">
                √ó
            </button>

            <!-- Header -->
            <h2 style="color: #00d4ff; margin: 0 0 20px 0; padding-right: 40px; font-size: 1.5rem;">üí± What is Cross-Exchange Arbitrage?</h2>

            <!-- Content -->
            <div style="color: #b8c6db; line-height: 1.6; font-size: 0.95rem; padding-right: 5px;">
                <p style="margin: 0 0 15px 0;">
                    <strong style="color: #00ff88;">Cross-exchange arbitrage</strong> exploits price differences for the <strong>same asset across different exchanges</strong>.
                </p>

                <div style="background: rgba(0,212,255,0.1); padding: 15px; border-radius: 8px; border-left: 4px solid #00d4ff; margin-bottom: 15px;">
                    <strong style="color: #00d4ff; display: block; margin-bottom: 8px;">Example:</strong>
                    <div style="font-family: monospace; color: #00ff88;">
                        Buy XRP on Binance @ $2.10<br>
                        Sell XRP on Kraken @ $2.15<br>
                        <span style="color: #ffb347;">Profit: $0.05 per XRP (2.4%)</span>
                    </div>
                </div>

                <p style="margin: 0 0 15px 0;">
                    <strong style="color: #ffb347;">How it works:</strong>
                </p>
                <ol style="margin: 0 0 15px 0; padding-left: 25px;">
                    <li style="margin-bottom: 8px;">System scans <strong>all connected exchanges</strong> for price differences</li>
                    <li style="margin-bottom: 8px;">Finds an asset trading <strong>cheaper</strong> on Exchange A</li>
                    <li style="margin-bottom: 8px;">Finds the same asset trading <strong>higher</strong> on Exchange B</li>
                    <li style="margin-bottom: 8px;">Executes <strong>simultaneous buy and sell</strong> orders</li>
                    <li style="margin-bottom: 8px;">Captures the <strong>price difference as profit</strong></li>
                </ol>

                <p style="margin: 0 0 15px 0;">
                    With <strong style="color: #00ff88;">19 connected exchanges and 150+ trading pairs</strong>, the system monitors over <strong style="color: #00ff88;">22,000 potential arbitrage opportunities</strong> in real-time! üöÄ
                </p>

                <div style="background: rgba(255,152,0,0.1); padding: 15px; border-radius: 8px; border-left: 4px solid #ffb347; margin-bottom: 0;">
                    <strong style="color: #ffb347;">Key Difference:</strong> Unlike triangular arbitrage (which happens on one exchange), cross-exchange arbitrage requires <strong>balances on multiple exchanges</strong> and involves <strong>transferring assets between exchanges</strong> when rebalancing is needed.
                </div>
            </div>
        </div>
    </div>

    <script>
        // Return to Platform Function
        function returnToPlatform() {
            // Set cross-exchange toggle state to OFF
            localStorage.setItem('crossExchangeActive', 'false');

            // Navigate back to main platform
            window.location.href = '/';
        }

        // All asset pairs available on the page
        const allAssetPairs = [
            'XRPUSDT', 'BTCUSDT', 'ETHUSDT', 'SOLUSDT', 'LINKUSDT', 'DOGEUSDT', 'ADAUSDT', 'DOTUSDT',
            'AVAXUSDT', 'MATICUSDT', 'LTCUSDT', 'ATOMUSDT', 'BNBUSDT', 'UNIUSDT', 'BCHUSDT', 'SHIBUSDT',
            'ETHBTC', 'ADABTC', 'DOTETH', 'LINKBTC', 'XRPBTC', 'XLMBTC', 'ALGOBTC', 'HBARBTC', 'HBARUSDT',
            'SOLBTC', 'MATICBTC', 'AVAXBTC', 'BNBBTC', 'LTCBTC', 'SOLETH', 'MATICETH', 'LINKETH', 'UNIETH',
            'BTCUSDC', 'ETHUSDC', 'SUNUSDT', 'UBXSUSDT', 'GMMTUSDT', 'SNPTUSDT', 'ONDOUSDT', 'TRADEUSDT',
            'TLOSUSDT', 'ZCXUSDT', 'PINUSDT', 'UDSUSDT', 'TETUSDT', 'OMIUSDT', 'HTXUSDT', 'BADUSDT',
            'DNXUSDT', 'HASHAIUSDT', 'XTAGUSDT', 'AIMONICAUSDT', 'IAGUSDT', 'SEIUSDT', 'MASAUSDT', 'TRVLUSDT',
            'OMNIAUSDT', 'ARCAUSDT', 'EVMOSUSDT', 'HEARTUSDT', 'XCADUSDT', 'ZCDUSDT', 'NAIUSDT', 'NPCUSDT',
            'HAIUSDT', 'NTXUSDT', 'TURBOUSDT', 'NOTUSDT', 'BLSUSDT', 'DFYNUSDT', 'STRMUSDT', 'XPRTUSDT',
            'HTMUSDT', 'TOKOUSDT', 'ATRUSDT', 'ATLASUSDT', 'PAWSUSDT', 'KASTAUSDT', 'PZPUSDT', 'QTLXUSDT',
            'SCPTUSDT', 'MTRGUSDT', 'VANRYUSDT', 'XRPHUSDT', 'ZANOUSDT', 'STBUUSDT', 'REKTUSDT', 'AGLAUSDT',
            'PROPCUSDT', 'SPARKLETUSDT', 'CSIXUSDT', 'HOODUSDT', 'MBGUSDT', 'SEEDUSDT', 'MUBIUSDT', 'XPUSDT',
            'SNYUSDT', 'PEPE2USDT', 'SWEATUSDT', 'KIPUSDT', 'VISTAUSDT', 'DKSUSDT', 'CKBUSDT', 'QUBICUSDT',
            'ETNUSDT', 'XLMUSDT', 'PEPEUSDT', 'AAVEUSDT', 'AGRIUSDT', 'ALGOUSDT', 'LUMENUSDT', 'SFIUSDT',
            'PROPSUSDT', 'VEMPUSDT', 'XRUSDT', 'XDCUSDT', 'GELUSDT', 'RTFUSDT', 'DCKUSDT', 'MOGUSDT',
            'RETIKUSDT', 'ARBUSDT', 'VSCUSDT', 'REDOUSDT', 'MEMEFIUSDT', 'MUBUSDT', 'AKIUSDT', 'XZKUSDT'
        ];

        // Load saved settings
        document.addEventListener('DOMContentLoaded', function() {
            // Load trading configuration from localStorage
            const maxTradeSize = localStorage.getItem('maxTradeSize');
            if (maxTradeSize) document.getElementById('maxTradeSize').value = maxTradeSize;

            const minProfitThreshold = localStorage.getItem('minProfitThreshold');
            if (minProfitThreshold) document.getElementById('minProfitThreshold').value = minProfitThreshold;

            const portfolioPercentage = localStorage.getItem('portfolioPercentage');
            if (portfolioPercentage) document.getElementById('portfolioPercentage').value = portfolioPercentage;

            // Log loaded risk settings
            console.log('\n‚öñÔ∏è RISK MANAGEMENT SETTINGS:');
            console.log(`  Max Trade Size: ${maxTradeSize || '1000'} USDT`);
            console.log(`  Min Profit Threshold: ${minProfitThreshold || '0.5'}%`);
            console.log(`  Portfolio % to Trade: ${portfolioPercentage || '10'}%`);

            // Load asset pair selections from localStorage
            console.log('üìã Loading asset pair selections from localStorage...');
            let loadedPairs = 0;
            allAssetPairs.forEach(asset => {
                const checkbox = document.getElementById(`asset_${asset}`);
                if (checkbox) {
                    const saved = localStorage.getItem(`asset_${asset}`);
                    // Default to checked if no saved state
                    checkbox.checked = saved === null ? true : saved === 'true';
                    if (checkbox.checked) loadedPairs++;

                    // Add event listener to save state when changed
                    checkbox.addEventListener('change', function() {
                        localStorage.setItem(`asset_${asset}`, this.checked);
                        console.log(`‚úèÔ∏è Asset ${asset} ${this.checked ? 'selected' : 'deselected'}`);
                        updateStats(); // Update counters immediately
                    });
                }
            });
            console.log(`‚úÖ Loaded ${loadedPairs} selected asset pairs`);

            // Update stats from localStorage or API
            console.log('\nüîç CROSS-EXCHANGE PAGE INITIALIZED');
            console.log('‚ïê'.repeat(60));
            updateStats();

            // Initialize crypto asset search
            initializeCryptoSearch();

            // Check if auto-trading is already enabled
            const autoTradingEnabled = localStorage.getItem('autoTradingEnabled');
            if (autoTradingEnabled === 'true') {
                console.log('‚ö° Auto-trading is already enabled - updating UI');
                const scanButton = document.querySelector('button[onclick="scanForOpportunities()"]');
                if (scanButton) {
                    scanButton.textContent = '‚è∏Ô∏è Disable Auto-Trading';
                    scanButton.style.background = 'linear-gradient(45deg, #ff6b6b 0%, #ff4444 100%)';
                    scanButton.onclick = stopScanning;
                }
                updateStatusIndicator(true);
                startListeningForUpdates();
            }
        });

        // Quick asset search functionality
        function initializeCryptoSearch() {
            const searchInput = document.getElementById('cryptoSearchInput');

            if (!searchInput) {
                console.log('‚ö†Ô∏è Search input not found, skipping search initialization');
                return;
            }

            // Search input event listener
            searchInput.addEventListener('input', function(e) {
                const query = e.target.value.trim().toLowerCase();

                console.log(`üîç Search query: "${query}"`);

                // Get all asset checkboxes
                let visibleCount = 0;
                let hiddenCount = 0;

                allAssetPairs.forEach(asset => {
                    const checkbox = document.getElementById(`asset_${asset}`);
                    if (checkbox && checkbox.parentElement) {
                        // Check if asset matches the query
                        const assetLower = asset.toLowerCase();
                        const matches = query.length === 0 || assetLower.includes(query);

                        // Show/hide the parent div containing the checkbox and label
                        if (matches) {
                            checkbox.parentElement.style.display = '';
                            visibleCount++;
                        } else {
                            checkbox.parentElement.style.display = 'none';
                            hiddenCount++;
                        }
                    }
                });

                if (query.length > 0) {
                    console.log(`üìä Search results: ${visibleCount} shown, ${hiddenCount} hidden`);
                }
            });

            console.log('‚úÖ Crypto asset search initialized');
        }

        // Save settings when changed
        document.getElementById('maxTradeSize').addEventListener('change', function() {
            localStorage.setItem('maxTradeSize', this.value);
        });

        document.getElementById('minProfitThreshold').addEventListener('change', function() {
            localStorage.setItem('minProfitThreshold', this.value);
            console.log(`‚öñÔ∏è Min profit threshold updated: ${this.value}%`);
        });

        document.getElementById('portfolioPercentage').addEventListener('change', function() {
            localStorage.setItem('portfolioPercentage', this.value);
            console.log(`üíº Portfolio % to trade updated: ${this.value}%`);
        });

        // Enable Auto-Trading
        let tradingEngineIframe = null;

        function scanForOpportunities() {
            console.log('\nüöÄ ENABLE AUTO-TRADING clicked');
            console.log('‚úÖ Enabling cross-exchange arbitrage auto-trading...');

            // Enable cross-exchange strategy and auto-trading in main system
            localStorage.setItem('crossExchangeActive', 'true');
            localStorage.setItem('autoTradingEnabled', 'true');
            localStorage.setItem('autoTradingCommand', Date.now().toString()); // Signal to start

            // Load trading engine in hidden iframe
            console.log('üîß Loading trading engine...');
            if (!tradingEngineIframe) {
                tradingEngineIframe = document.createElement('iframe');
                tradingEngineIframe.src = '/';
                tradingEngineIframe.style.display = 'none'; // Hidden from view
                tradingEngineIframe.style.position = 'absolute';
                tradingEngineIframe.style.width = '0';
                tradingEngineIframe.style.height = '0';
                tradingEngineIframe.style.border = 'none';
                document.body.appendChild(tradingEngineIframe);
            }

            console.log('‚úÖ Auto-trading enabled');
            console.log('‚úÖ Trading engine running in background');
            console.log('üí° Trades will execute automatically when opportunities found');
            console.log('üí° Stay on this page - all updates will appear here');

            // Update UI to show active state
            const scanButton = event.target;
            scanButton.textContent = '‚è∏Ô∏è Disable Auto-Trading';
            scanButton.style.background = 'linear-gradient(45deg, #ff6b6b 0%, #ff4444 100%)';
            scanButton.onclick = stopScanning;

            // Show active indicator
            updateStatusIndicator(true);

            // Start listening for updates from index.html
            startListeningForUpdates();
        }

        function stopScanning() {
            console.log('\n‚è∏Ô∏è DISABLE AUTO-TRADING clicked');

            // Disable auto-trading in main system
            localStorage.setItem('autoTradingEnabled', 'false');
            localStorage.setItem('autoTradingCommand', Date.now().toString()); // Signal to stop

            // Stop and remove trading engine iframe
            if (tradingEngineIframe) {
                document.body.removeChild(tradingEngineIframe);
                tradingEngineIframe = null;
                console.log('‚úÖ Trading engine stopped');
            }

            // Update UI back to enabled state
            const scanButton = event.target;
            scanButton.textContent = 'üöÄ Enable Auto-Trading';
            scanButton.style.background = 'linear-gradient(45deg, #00ff88 0%, #00cc66 100%)';
            scanButton.onclick = scanForOpportunities;

            // Hide active indicator
            updateStatusIndicator(false);

            console.log('‚úÖ Auto-trading disabled');
        }

        function updateStatusIndicator(isActive) {
            // Update the status banner at top
            const statusBanner = document.querySelector('.strategy-status');
            if (statusBanner) {
                if (isActive) {
                    statusBanner.innerHTML = '<span style="color: #ff6b6b;">‚ö° AUTO-TRADING ACTIVE</span>';
                    statusBanner.style.background = 'linear-gradient(135deg, rgba(255,107,107,0.2) 0%, rgba(255,68,68,0.2) 100%)';
                } else {
                    statusBanner.innerHTML = '<span style="color: #00ff88;">‚úÖ CROSS-EXCHANGE ARB ACTIVE</span>';
                    statusBanner.style.background = 'linear-gradient(135deg, rgba(0,255,136,0.2) 0%, rgba(0,212,255,0.2) 100%)';
                }
            }
        }

        function startListeningForUpdates() {
            console.log('üëÇ Listening for live updates from trading engine...');

            // Listen for localStorage changes from index.html
            window.addEventListener('storage', function(e) {
                if (e.key === 'liveOpportunity') {
                    const opportunity = JSON.parse(e.newValue);
                    displayOpportunity(opportunity);
                } else if (e.key === 'tradeExecuted') {
                    const trade = JSON.parse(e.newValue);
                    addTradeToHistory(trade);
                } else if (e.key === 'scannerStats') {
                    const stats = JSON.parse(e.newValue);
                    updateStatsFromScanner(stats);
                }
            });
        }

        function displayOpportunity(opportunity) {
            console.log('üí∞ Live opportunity received:', opportunity);
            // Update the "Opportunities Today" or create a live feed
            // This will be visible in the Recent Trades section
        }

        function addTradeToHistory(trade) {
            console.log('üìä Trade executed:', trade);
            // Add to Recent Trades section dynamically
            const tradesContainer = document.querySelector('.recent-trades-container');
            if (tradesContainer) {
                const tradeHtml = `
                    <div style="padding: 15px; border-bottom: 1px solid rgba(255,255,255,0.1);">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <div style="font-weight: bold; color: #00ff88;">${trade.asset}</div>
                                <div style="font-size: 0.85rem; color: #b8c6db;">
                                    Buy: ${trade.buyExchange} ‚Üí Sell: ${trade.sellExchange}
                                </div>
                            </div>
                            <div style="text-align: right;">
                                <div style="color: ${trade.profit > 0 ? '#00ff88' : '#ff6b6b'}; font-weight: bold;">
                                    ${trade.profit > 0 ? '+' : ''}$${trade.profit.toFixed(2)}
                                </div>
                                <div style="font-size: 0.85rem; color: #b8c6db;">
                                    ${new Date(trade.time).toLocaleTimeString()}
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                tradesContainer.insertAdjacentHTML('afterbegin', tradeHtml);
            }
        }

        function updateStatsFromScanner(stats) {
            console.log('üìä Scanner stats updated:', stats);
            if (stats.todayProfit !== undefined) {
                const profitElement = document.getElementById('totalProfit');
                if (profitElement) {
                    profitElement.textContent = `$${stats.todayProfit.toFixed(2)}`;
                }
            }
        }

        function viewTradeHistory() {
            console.log('\nüìä VIEW TRADE HISTORY button clicked');
            // Load trade history from localStorage
            const tradeHistory = JSON.parse(localStorage.getItem('arb4me_data'))?.tradeHistory || [];
            console.log(`üìú Found ${tradeHistory.length} trades in history`);

            if (tradeHistory.length === 0) {
                alert('No trade history available yet. Start scanning to execute trades!');
            } else {
                alert(`Trade History:\n${tradeHistory.length} trades executed\nTotal: $${tradeHistory.reduce((sum, t) => sum + (t.profit || 0), 0).toFixed(2)}`);
            }
        }

        function configureExchanges() {
            console.log('\n‚öôÔ∏è CONFIGURE EXCHANGES button clicked');
            console.log('üí° Redirecting to Strategy API Configuration page...');
            window.location.href = '/strategy-api-setup.html';
        }

        function exportData() {
            console.log('\nüì• EXPORT DATA button clicked');
            console.log('‚ö†Ô∏è Note: Export functionality not yet implemented on this page');
            alert('Exporting trade data...');
        }

        function updateStats() {
            console.log('\nüìä UPDATING STATS...');

            // Count connected exchanges from localStorage (NEW cross-exchange strategy format)
            let connectedCount = 0;
            const connectedExchangesList = [];
            const exchanges = ['valr', 'luno', 'altcointrader', 'xago', 'chainex', 'kraken', 'binance', 'bybit', 'gateio', 'okx', 'mexc', 'kucoin', 'xt', 'ascendex', 'htx', 'bingx', 'bitget', 'bitmart', 'bitrue', 'gemini', 'cryptocom', 'coincatch'];
            exchanges.forEach(exchange => {
                // Check NEW strategy-specific format: ${exchange}_cross-exchange_connected
                if (localStorage.getItem(`${exchange}_cross-exchange_connected`) === 'true') {
                    connectedCount++;
                    connectedExchangesList.push(exchange.toUpperCase());
                }
            });
            document.getElementById('connectedExchanges').textContent = connectedCount;
            console.log(`üîó Connected Exchanges (${connectedCount}):`, connectedExchangesList.join(', ') || 'none');

            // Count active pairs (all pairs in allAssetPairs array)
            let activePairs = 0;
            const selectedPairsList = [];
            allAssetPairs.forEach(asset => {
                const saved = localStorage.getItem(`asset_${asset}`);
                // Count as active if checked (default to true if no saved state)
                if (saved === null || saved === 'true') {
                    activePairs++;
                    selectedPairsList.push(asset);
                }
            });
            document.getElementById('activePairs').textContent = activePairs;
            console.log(`üìà Selected Asset Pairs (${activePairs}):`, selectedPairsList.join(', '));

            // Calculate opportunities for CROSS-EXCHANGE arbitrage
            // Cross-exchange requires comparing prices between PAIRS of exchanges
            // For N exchanges, there are N √ó (N-1) / 2 unique exchange pairs
            // Example: 19 exchanges = 19 √ó 18 / 2 = 171 exchange pairs
            // (VALR‚ÜîBinance, VALR‚ÜîOKX, Binance‚ÜîKuCoin, etc.)
            let exchangePairs = 0;
            if (connectedCount >= 2) {
                exchangePairs = (connectedCount * (connectedCount - 1)) / 2;
            }
            console.log(`üîÑ Exchange Pairs: ${connectedCount} exchanges = ${exchangePairs} unique pairs`);

            // Total opportunities = trading pairs √ó exchange pair combinations
            // Example: 130 pairs √ó 171 exchange pairs = 22,230 potential arbitrage routes
            const opportunities = activePairs * exchangePairs;
            document.getElementById('opportunitiesToday').textContent = opportunities.toLocaleString();
            console.log(`üí° Total Opportunities: ${activePairs} pairs √ó ${exchangePairs} exchange pairs = ${opportunities.toLocaleString()}`);
            console.log('‚ïê'.repeat(60));
        }

        // ============================================================================
        // CROSS-EXCHANGE ARBITRAGE ABOUT MODAL
        // ============================================================================

        function openCrossExchangeAboutModal() {
            const modal = document.getElementById('crossExchangeAboutModal');
            if (modal) {
                modal.style.display = 'flex';
                console.log('‚ÑπÔ∏è [About Modal] Cross-Exchange Arbitrage info opened');
            }
        }

        function closeCrossExchangeAboutModal() {
            const modal = document.getElementById('crossExchangeAboutModal');
            if (modal) {
                modal.style.display = 'none';
                console.log('‚ÑπÔ∏è [About Modal] Cross-Exchange Arbitrage info closed');
            }
        }

        // Close modal when clicking outside the content
        document.addEventListener('click', function(event) {
            const modal = document.getElementById('crossExchangeAboutModal');
            if (event.target === modal) {
                closeCrossExchangeAboutModal();
            }
        });

        // Close modal with Escape key
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                closeCrossExchangeAboutModal();
            }
        });

        // End of About Modal Functionality

        // ============================================================================
        // TEST SCAN MODE - Cross-Exchange Arbitrage Simulation
        // ============================================================================

        // Global variable to track test scan state
        let crossExTestScanRunning = false;

        /**
         * Select all exchanges for test scan
         */
        function selectAllTestScanExchanges() {
            const checkboxes = document.querySelectorAll('.test-scan-exchange');
            checkboxes.forEach(cb => cb.checked = true);
            console.log('‚úì All exchanges selected for test scan');
        }

        /**
         * Deselect all exchanges for test scan
         */
        function deselectAllTestScanExchanges() {
            const checkboxes = document.querySelectorAll('.test-scan-exchange');
            checkboxes.forEach(cb => cb.checked = false);
            console.log('‚úó All exchanges deselected for test scan');
        }

        /**
         * Populate test scan asset grid with all available assets
         */
        function populateTestScanAssets() {
            const grid = document.getElementById('testScanAssetGrid');
            if (!grid) return;

            let html = '';
            allAssetPairs.forEach(asset => {
                // Check by default for major pairs
                const majorPairs = ['XRPUSDT', 'BTCUSDT', 'ETHUSDT', 'SOLUSDT', 'LINKUSDT', 'DOGEUSDT',
                                   'ADAUSDT', 'MATICUSDT', 'BNBUSDT', 'LTCUSDT', 'XLMUSDT', 'ALGOUSDT'];
                const isChecked = majorPairs.includes(asset) ? 'checked' : '';

                html += `
                    <label style="color: #b8c6db; font-size: 0.75rem; cursor: pointer; display: flex; align-items: center; padding: 4px; background: rgba(255,255,255,0.05); border-radius: 4px;">
                        <input type="checkbox" class="cross-ex-test-scan-asset" value="${asset}" ${isChecked} style="margin-right: 6px;" onchange="updateTestScanAssetCount()">
                        <span>${asset}</span>
                    </label>
                `;
            });

            grid.innerHTML = html;
            updateTestScanAssetCount();
        }

        /**
         * Update count of selected test scan assets
         */
        function updateTestScanAssetCount() {
            const count = document.querySelectorAll('.cross-ex-test-scan-asset:checked').length;
            const countEl = document.getElementById('testScanAssetCount');
            if (countEl) {
                countEl.textContent = `${count} selected`;
                countEl.style.color = count > 0 ? '#00ff88' : '#888';
            }
        }

        /**
         * Select all assets for test scan
         */
        function selectAllCrossExAssets() {
            const checkboxes = document.querySelectorAll('.cross-ex-test-scan-asset');
            checkboxes.forEach(cb => cb.checked = true);
            updateTestScanAssetCount();
            console.log('‚úì All assets selected for test scan');
        }

        /**
         * Deselect all assets for test scan
         */
        function deselectAllCrossExAssets() {
            const checkboxes = document.querySelectorAll('.cross-ex-test-scan-asset');
            checkboxes.forEach(cb => cb.checked = false);
            updateTestScanAssetCount();
            console.log('‚úó All assets deselected for test scan');
        }

        /**
         * Start Cross-Exchange Test Scan
         */
        async function startCrossExchangeTestScan() {
            if (crossExTestScanRunning) {
                console.warn('‚ö†Ô∏è Test scan already running');
                return;
            }

            console.log('\nüî¨ ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê');
            console.log('üî¨ STARTING CROSS-EXCHANGE TEST SCAN');
            console.log('üî¨ ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê');

            crossExTestScanRunning = true;
            const scanStartTime = Date.now();

            // Update UI - disable start button, enable stop button
            document.getElementById('startCrossExTestScanBtn').disabled = true;
            document.getElementById('startCrossExTestScanBtn').style.opacity = '0.5';
            document.getElementById('stopCrossExTestScanBtn').disabled = false;
            document.getElementById('stopCrossExTestScanBtn').style.background = 'linear-gradient(135deg, #ff6b6b, #ee5a24)';
            document.getElementById('stopCrossExTestScanBtn').style.color = '#fff';
            document.getElementById('stopCrossExTestScanBtn').style.cursor = 'pointer';

            // Show scanning status
            document.getElementById('crossExTestScanStatus').style.display = 'block';

            try {
                // Step 1: Get selected exchanges
                const selectedExchanges = Array.from(document.querySelectorAll('.test-scan-exchange:checked'))
                    .map(cb => cb.value);

                if (selectedExchanges.length < 2) {
                    alert('‚ö†Ô∏è Please select at least 2 exchanges for cross-exchange arbitrage');
                    stopCrossExchangeTestScan();
                    return;
                }

                console.log(`üìä Selected Exchanges (${selectedExchanges.length}):`, selectedExchanges);

                // Update status dashboard
                document.getElementById('crossExStatusText').style.color = '#00d4ff';
                document.getElementById('crossExStatusText').textContent = 'üîµ SCANNING...';
                document.getElementById('crossExCurrentSet').textContent =
                    `Fetching prices from ${selectedExchanges.length} exchanges...`;

                // Step 2: Get selected assets from test scan asset selector
                const selectedAssets = Array.from(document.querySelectorAll('.cross-ex-test-scan-asset:checked'))
                    .map(checkbox => checkbox.value);

                if (selectedAssets.length === 0) {
                    alert('‚ö†Ô∏è Please select at least 1 asset in the Asset Selection section');
                    stopCrossExchangeTestScan();
                    return;
                }

                console.log(`üíé Selected Assets (${selectedAssets.length}):`, selectedAssets);
                document.getElementById('crossExCurrentSet').textContent =
                    `Analyzing ${selectedAssets.length} assets across ${selectedExchanges.length} exchanges...`;

                // Step 3: Fetch prices from all exchanges
                console.log('üì° Fetching prices from price cache service...');
                const exchangePrices = {};

                for (const exchange of selectedExchanges) {
                    try {
                        const response = await fetch(`/api/v1/transfer-arb/price-cache/${exchange}`);
                        if (response.ok) {
                            exchangePrices[exchange] = await response.json();
                            console.log(`‚úì ${exchange}: ${Object.keys(exchangePrices[exchange]).length} prices fetched`);
                        } else {
                            console.warn(`‚ö†Ô∏è ${exchange}: Failed to fetch prices (${response.status})`);
                            exchangePrices[exchange] = {};
                        }
                    } catch (error) {
                        console.error(`‚ùå ${exchange}: Error fetching prices:`, error.message);
                        exchangePrices[exchange] = {};
                    }
                }

                // Step 4: Calculate all cross-exchange opportunities
                console.log('üîç Calculating cross-exchange opportunities...');
                document.getElementById('crossExCurrentSet').textContent =
                    'Calculating arbitrage opportunities...';

                const opportunities = [];
                let totalScanned = 0;

                // For each asset
                for (const asset of selectedAssets) {
                    // For each pair of exchanges (i < j to avoid duplicates)
                    for (let i = 0; i < selectedExchanges.length; i++) {
                        for (let j = i + 1; j < selectedExchanges.length; j++) {
                            const buyExchange = selectedExchanges[i];
                            const sellExchange = selectedExchanges[j];

                            totalScanned++;

                            // Get prices for this asset on both exchanges
                            const buyPrice = getBidAskPrice(exchangePrices[buyExchange], asset, 'ask');
                            const sellPrice = getBidAskPrice(exchangePrices[sellExchange], asset, 'bid');

                            if (buyPrice && sellPrice && buyPrice.ask > 0 && sellPrice.bid > 0) {
                                // Calculate profit (buy from buyExchange, sell to sellExchange)
                                const spreadPercent = ((sellPrice.bid - buyPrice.ask) / buyPrice.ask) * 100;
                                const netPercent = spreadPercent - 0.2; // 0.1% fee on each side = 0.2% total

                                opportunities.push({
                                    asset,
                                    buyExchange: formatExchangeName(buyExchange),
                                    sellExchange: formatExchangeName(sellExchange),
                                    buyPrice: buyPrice.ask,
                                    sellPrice: sellPrice.bid,
                                    spreadPercent,
                                    netPercent
                                });
                            }

                            // Also check the reverse direction (buy from sellExchange, sell to buyExchange)
                            const reverseBuyPrice = getBidAskPrice(exchangePrices[sellExchange], asset, 'ask');
                            const reverseSellPrice = getBidAskPrice(exchangePrices[buyExchange], asset, 'bid');

                            if (reverseBuyPrice && reverseSellPrice && reverseBuyPrice.ask > 0 && reverseSellPrice.bid > 0) {
                                const spreadPercent = ((reverseSellPrice.bid - reverseBuyPrice.ask) / reverseBuyPrice.ask) * 100;
                                const netPercent = spreadPercent - 0.2;

                                opportunities.push({
                                    asset,
                                    buyExchange: formatExchangeName(sellExchange),
                                    sellExchange: formatExchangeName(buyExchange),
                                    buyPrice: reverseBuyPrice.ask,
                                    sellPrice: reverseSellPrice.bid,
                                    spreadPercent,
                                    netPercent
                                });
                            }
                        }
                    }
                }

                // Step 5: Sort opportunities by net profit (highest first)
                opportunities.sort((a, b) => b.netPercent - a.netPercent);

                // Step 6: Save opportunities to localStorage and update all tables
                const scanData = getCrossExScanData();

                // Set start time if first scan
                if (!scanData.startTime) {
                    scanData.startTime = Date.now();
                }

                // Increment cycle count
                scanData.cycles++;

                // Add all opportunities to aggregated data
                opportunities.forEach(opp => addOpportunityToData(scanData, opp));

                // Save updated data
                saveCrossExScanData(scanData);

                // Update all tables and dashboard
                populateAllTables();

                // Update status text
                document.getElementById('crossExStatusText').style.color = '#00ff88';
                document.getElementById('crossExStatusText').textContent = '‚úÖ SCAN COMPLETE';
                document.getElementById('crossExCurrentSet').textContent =
                    `Last scan: ${selectedAssets.length} assets √ó ${selectedExchanges.length} exchanges`;

                console.log('‚úÖ Test scan completed successfully');
                console.log(`üìä Total opportunities scanned: ${totalScanned.toLocaleString()}`);
                console.log(`üí∞ Profitable opportunities found: ${opportunities.filter(o => o.netPercent > 0).length}`);
                console.log(`üóÑÔ∏è  Total data collected: ${scanData.totalOpportunities.toLocaleString()}`);
                console.log(`üîÑ Scan cycle: ${scanData.cycles}`);
                console.log('üî¨ ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n');

            } catch (error) {
                console.error('‚ùå Test scan failed:', error);
                alert(`Test scan failed: ${error.message}`);

                // Update status to show error
                document.getElementById('crossExStatusText').style.color = '#ff6b6b';
                document.getElementById('crossExStatusText').textContent = '‚ùå SCAN FAILED';
                document.getElementById('crossExCurrentSet').textContent = `Error: ${error.message}`;
            } finally {
                // Status dashboard stays visible (don't hide it)

                // Reset button states
                document.getElementById('startCrossExTestScanBtn').disabled = false;
                document.getElementById('startCrossExTestScanBtn').style.opacity = '1';
                document.getElementById('stopCrossExTestScanBtn').disabled = true;
                document.getElementById('stopCrossExTestScanBtn').style.background = 'rgba(255,107,107,0.5)';
                document.getElementById('stopCrossExTestScanBtn').style.color = 'rgba(255,255,255,0.5)';
                document.getElementById('stopCrossExTestScanBtn').style.cursor = 'not-allowed';

                crossExTestScanRunning = false;
            }
        }

        /**
         * Stop Cross-Exchange Test Scan
         */
        function stopCrossExchangeTestScan() {
            crossExTestScanRunning = false;
            document.getElementById('crossExTestScanStatus').style.display = 'none';

            // Reset button states
            document.getElementById('startCrossExTestScanBtn').disabled = false;
            document.getElementById('startCrossExTestScanBtn').style.opacity = '1';
            document.getElementById('stopCrossExTestScanBtn').disabled = true;
            document.getElementById('stopCrossExTestScanBtn').style.background = 'rgba(255,107,107,0.5)';
            document.getElementById('stopCrossExTestScanBtn').style.color = 'rgba(255,255,255,0.5)';
            document.getElementById('stopCrossExTestScanBtn').style.cursor = 'not-allowed';

            console.log('‚èπÔ∏è Test scan stopped');
        }

        /**
         * Get bid/ask price for an asset from exchange prices
         * @param {object} exchangePrices - Price data from exchange
         * @param {string} asset - Asset symbol (e.g., "XRPUSDT")
         * @param {string} type - 'bid' or 'ask'
         * @returns {object|null} Price object with bid/ask or null if not found
         */
        function getBidAskPrice(exchangePrices, asset, type) {
            if (!exchangePrices || typeof exchangePrices !== 'object') {
                return null;
            }

            // Try different asset format variations
            const variations = [
                asset,                          // XRPUSDT
                asset.replace('USDT', '/USDT'), // XRP/USDT
                asset.replace('USDT', '-USDT'), // XRP-USDT
                asset.replace('BTC', '/BTC'),   // ETH/BTC
                asset.replace('BTC', '-BTC'),   // ETH-BTC
                asset.replace('ETH', '/ETH'),   // DOT/ETH
                asset.replace('ETH', '-ETH')    // DOT-ETH
            ];

            for (const variation of variations) {
                if (exchangePrices[variation]) {
                    return {
                        bid: exchangePrices[variation].bid || 0,
                        ask: exchangePrices[variation].ask || 0
                    };
                }
            }

            return null;
        }

        /**
         * Format exchange name for display
         * @param {string} exchange - Exchange identifier (e.g., "binance")
         * @returns {string} Formatted exchange name (e.g., "Binance")
         */
        function formatExchangeName(exchange) {
            const names = {
                'binance': 'Binance',
                'kraken': 'Kraken',
                'okx': 'OKX',
                'bybit': 'Bybit',
                'kucoin': 'Kucoin',
                'mexc': 'MEXC',
                'htx': 'HTX',
                'gateio': 'Gate.io',
                'bitget': 'Bitget',
                'valr': 'VALR',
                'luno': 'Luno',
                'gemini': 'Gemini',
                'bitmart': 'Bitmart',
                'bitrue': 'Bitrue',
                'xtcom': 'XT.com',
                'cryptocom': 'Crypto.com',
                'chainex': 'Chainex',
                'coincatch': 'Coincatch',
                'bingx': 'BingX',
                'ascendex': 'Ascendex'
            };
            return names[exchange] || exchange.toUpperCase();
        }

        // ============================================================================
        // LOCAL STORAGE DATA MANAGEMENT
        // ============================================================================

        /**
         * Get scan data from localStorage
         */
        function getCrossExScanData() {
            const data = localStorage.getItem('crossExTestScanData');
            if (!data) {
                return {
                    routes: {},
                    cryptos: {},
                    exchanges: {},
                    hourly: {},
                    cycles: 0,
                    totalOpportunities: 0,
                    startTime: null
                };
            }
            return JSON.parse(data);
        }

        /**
         * Save scan data to localStorage
         */
        function saveCrossExScanData(data) {
            localStorage.setItem('crossExTestScanData', JSON.stringify(data));
        }

        /**
         * Clear all scan data
         */
        function clearCrossExScanData() {
            localStorage.removeItem('crossExTestScanData');
            location.reload();
        }

        /**
         * Add opportunity to aggregated data
         */
        function addOpportunityToData(data, opportunity) {
            const routeKey = `${opportunity.buyExchange}‚Üí${opportunity.sellExchange}|${opportunity.asset}`;
            const hour = new Date().getHours();

            // Update route data
            if (!data.routes[routeKey]) {
                data.routes[routeKey] = {
                    asset: opportunity.asset,
                    buyExchange: opportunity.buyExchange,
                    sellExchange: opportunity.sellExchange,
                    timesFound: 0,
                    profits: [],
                    avgProfit: 0,
                    bestProfit: -Infinity,
                    worstProfit: Infinity,
                    lastSeen: null,
                    timestamps: []
                };
            }

            const route = data.routes[routeKey];
            route.timesFound++;
            route.profits.push(opportunity.netPercent);
            route.timestamps.push(Date.now());
            route.lastSeen = Date.now();
            route.bestProfit = Math.max(route.bestProfit, opportunity.netPercent);
            route.worstProfit = Math.min(route.worstProfit, opportunity.netPercent);
            route.avgProfit = route.profits.reduce((a, b) => a + b, 0) / route.profits.length;

            // Update crypto data
            if (!data.cryptos[opportunity.asset]) {
                data.cryptos[opportunity.asset] = {
                    opportunities: 0,
                    profits: [],
                    avgProfit: 0
                };
            }
            data.cryptos[opportunity.asset].opportunities++;
            data.cryptos[opportunity.asset].profits.push(opportunity.netPercent);
            data.cryptos[opportunity.asset].avgProfit =
                data.cryptos[opportunity.asset].profits.reduce((a, b) => a + b, 0) /
                data.cryptos[opportunity.asset].profits.length;

            // Update exchange pair data
            const exchangePairKey = `${opportunity.buyExchange}‚Üí${opportunity.sellExchange}`;
            if (!data.exchanges[exchangePairKey]) {
                data.exchanges[exchangePairKey] = {
                    opportunities: 0,
                    profits: [],
                    avgProfit: 0
                };
            }
            data.exchanges[exchangePairKey].opportunities++;
            data.exchanges[exchangePairKey].profits.push(opportunity.netPercent);
            data.exchanges[exchangePairKey].avgProfit =
                data.exchanges[exchangePairKey].profits.reduce((a, b) => a + b, 0) /
                data.exchanges[exchangePairKey].profits.length;

            // Update hourly data
            if (!data.hourly[hour]) {
                data.hourly[hour] = {
                    opportunities: 0,
                    profits: [],
                    avgProfit: 0,
                    routes: {}
                };
            }
            data.hourly[hour].opportunities++;
            data.hourly[hour].profits.push(opportunity.netPercent);
            data.hourly[hour].avgProfit =
                data.hourly[hour].profits.reduce((a, b) => a + b, 0) /
                data.hourly[hour].profits.length;

            if (!data.hourly[hour].routes[routeKey]) {
                data.hourly[hour].routes[routeKey] = 0;
            }
            data.hourly[hour].routes[routeKey]++;

            data.totalOpportunities++;
        }

        // ============================================================================
        // TABLE POPULATION FUNCTIONS
        // ============================================================================

        /**
         * Populate all analysis tables
         */
        function populateAllTables() {
            const data = getCrossExScanData();
            populateTopProfitTable(data);
            populateTopConsistencyTable(data);
            populateBestCryptosTable(data);
            populateBestExchangesTable(data);
            populateTimeAnalysisTable(data);
            updateStatusDashboard(data);
        }

        /**
         * Populate Top 20 Routes by Profit % table
         */
        function populateTopProfitTable(data) {
            const tbody = document.getElementById('crossExTopProfitBody');

            // Convert routes object to array and sort by avg profit
            const routes = Object.values(data.routes)
                .sort((a, b) => b.avgProfit - a.avgProfit)
                .slice(0, 20);

            if (routes.length === 0) {
                tbody.innerHTML = '<tr><td colspan="7" style="text-align: center; padding: 30px; color: #888;">No data yet. Start scanning to see results.</td></tr>';
                return;
            }

            let html = '';
            routes.forEach((route, index) => {
                const profitColor = route.avgProfit > 0 ? '#00ff88' : '#ff6b6b';
                const timeSinceLastSeen = route.lastSeen ?
                    Math.floor((Date.now() - route.lastSeen) / 1000) : 0;
                const lastSeenText = timeSinceLastSeen < 60 ?
                    `${timeSinceLastSeen}s ago` :
                    `${Math.floor(timeSinceLastSeen / 60)}m ago`;

                html += `
                    <tr style="border-bottom: 1px solid rgba(255,255,255,0.05);">
                        <td style="padding: 10px; color: #888;">${index + 1}</td>
                        <td style="padding: 10px; color: #00d4ff;">${route.buyExchange} ‚Üí ${route.sellExchange}</td>
                        <td style="padding: 10px; color: #ffb347;">${route.asset}</td>
                        <td style="padding: 10px; text-align: right; color: ${profitColor}; font-weight: bold;">
                            ${route.avgProfit > 0 ? '+' : ''}${route.avgProfit.toFixed(2)}%
                        </td>
                        <td style="padding: 10px; text-align: right; color: #00ff88; font-weight: bold;">
                            ${route.bestProfit > 0 ? '+' : ''}${route.bestProfit.toFixed(2)}%
                        </td>
                        <td style="padding: 10px; text-align: right; color: #b8c6db;">${route.timesFound}</td>
                        <td style="padding: 10px; text-align: right; color: #888; font-size: 0.85rem;">${lastSeenText}</td>
                    </tr>
                `;
            });

            tbody.innerHTML = html;
        }

        /**
         * Populate Top 20 Routes by Consistency table
         */
        function populateTopConsistencyTable(data) {
            const tbody = document.getElementById('crossExTopConsistencyBody');

            // Calculate consistency score (timesFound * avgProfit / stdDev)
            const routes = Object.values(data.routes)
                .map(route => {
                    const consistency = route.timesFound >= 3 ?
                        (route.timesFound / Math.max(1, route.bestProfit - route.worstProfit)) * 100 : 0;
                    return { ...route, consistency };
                })
                .sort((a, b) => b.consistency - a.consistency)
                .slice(0, 20);

            if (routes.length === 0) {
                tbody.innerHTML = '<tr><td colspan="7" style="text-align: center; padding: 30px; color: #888;">No data yet. Start scanning to see results.</td></tr>';
                return;
            }

            let html = '';
            routes.forEach((route, index) => {
                const profitColor = route.avgProfit > 0 ? '#00ff88' : '#ff6b6b';
                const consistencyColor = route.consistency > 50 ? '#00ff88' :
                                        route.consistency > 20 ? '#ffc107' : '#ff6b6b';

                html += `
                    <tr style="border-bottom: 1px solid rgba(255,255,255,0.05);">
                        <td style="padding: 10px; color: #888;">${index + 1}</td>
                        <td style="padding: 10px; color: #00d4ff;">${route.buyExchange} ‚Üí ${route.sellExchange}</td>
                        <td style="padding: 10px; color: #ffb347;">${route.asset}</td>
                        <td style="padding: 10px; text-align: right; color: #b8c6db;">${route.timesFound}</td>
                        <td style="padding: 10px; text-align: right; color: ${profitColor}; font-weight: bold;">
                            ${route.avgProfit > 0 ? '+' : ''}${route.avgProfit.toFixed(2)}%
                        </td>
                        <td style="padding: 10px; text-align: right; color: #888; font-size: 0.85rem;">
                            ${route.worstProfit.toFixed(2)}% / ${route.bestProfit.toFixed(2)}%
                        </td>
                        <td style="padding: 10px; text-align: center;">
                            <span style="background: ${consistencyColor}; color: #0c0c1e; padding: 4px 8px; border-radius: 4px; font-weight: bold; font-size: 0.85rem;">
                                ${route.consistency.toFixed(0)}
                            </span>
                        </td>
                    </tr>
                `;
            });

            tbody.innerHTML = html;
        }

        /**
         * Populate Best Cryptos table
         */
        function populateBestCryptosTable(data) {
            const tbody = document.getElementById('crossExBestCryptosBody');

            const cryptos = Object.entries(data.cryptos)
                .map(([asset, stats]) => ({ asset, ...stats }))
                .sort((a, b) => b.avgProfit - a.avgProfit)
                .slice(0, 10);

            if (cryptos.length === 0) {
                tbody.innerHTML = '<tr><td colspan="3" style="text-align: center; padding: 20px; color: #888;">No data yet</td></tr>';
                return;
            }

            let html = '';
            cryptos.forEach(crypto => {
                const profitColor = crypto.avgProfit > 0 ? '#00ff88' : '#ff6b6b';
                html += `
                    <tr style="border-bottom: 1px solid rgba(255,255,255,0.05);">
                        <td style="padding: 10px; color: #ffb347; font-weight: bold;">${crypto.asset}</td>
                        <td style="padding: 10px; text-align: right; color: #b8c6db;">${crypto.opportunities}</td>
                        <td style="padding: 10px; text-align: right; color: ${profitColor}; font-weight: bold;">
                            ${crypto.avgProfit > 0 ? '+' : ''}${crypto.avgProfit.toFixed(2)}%
                        </td>
                    </tr>
                `;
            });

            tbody.innerHTML = html;
        }

        /**
         * Populate Best Exchange Pairs table
         */
        function populateBestExchangesTable(data) {
            const tbody = document.getElementById('crossExBestExchangesBody');

            const exchanges = Object.entries(data.exchanges)
                .map(([pair, stats]) => ({ pair, ...stats }))
                .sort((a, b) => b.avgProfit - a.avgProfit)
                .slice(0, 10);

            if (exchanges.length === 0) {
                tbody.innerHTML = '<tr><td colspan="3" style="text-align: center; padding: 20px; color: #888;">No data yet</td></tr>';
                return;
            }

            let html = '';
            exchanges.forEach(exchange => {
                const profitColor = exchange.avgProfit > 0 ? '#00ff88' : '#ff6b6b';
                html += `
                    <tr style="border-bottom: 1px solid rgba(255,255,255,0.05);">
                        <td style="padding: 10px; color: #00d4ff;">${exchange.pair}</td>
                        <td style="padding: 10px; text-align: right; color: #b8c6db;">${exchange.opportunities}</td>
                        <td style="padding: 10px; text-align: right; color: ${profitColor}; font-weight: bold;">
                            ${exchange.avgProfit > 0 ? '+' : ''}${exchange.avgProfit.toFixed(2)}%
                        </td>
                    </tr>
                `;
            });

            tbody.innerHTML = html;
        }

        /**
         * Populate Time of Day Analysis table
         */
        function populateTimeAnalysisTable(data) {
            const tbody = document.getElementById('crossExTimeAnalysisBody');

            const hours = Object.entries(data.hourly)
                .map(([hour, stats]) => {
                    // Find most common route for this hour
                    const mostCommonRoute = Object.entries(stats.routes)
                        .sort((a, b) => b[1] - a[1])[0];
                    return {
                        hour: parseInt(hour),
                        ...stats,
                        mostCommonRoute: mostCommonRoute ? mostCommonRoute[0] : 'N/A'
                    };
                })
                .sort((a, b) => b.avgProfit - a.avgProfit);

            if (hours.length === 0) {
                tbody.innerHTML = '<tr><td colspan="4" style="text-align: center; padding: 20px; color: #888;">No data yet</td></tr>';
                return;
            }

            let html = '';
            hours.forEach(hourData => {
                const profitColor = hourData.avgProfit > 0 ? '#00ff88' : '#ff6b6b';
                const hourFormatted = hourData.hour.toString().padStart(2, '0') + ':00';

                html += `
                    <tr style="border-bottom: 1px solid rgba(255,255,255,0.05);">
                        <td style="padding: 10px; color: #b8c6db;">${hourFormatted}</td>
                        <td style="padding: 10px; text-align: right; color: #b8c6db;">${hourData.opportunities}</td>
                        <td style="padding: 10px; text-align: right; color: ${profitColor}; font-weight: bold;">
                            ${hourData.avgProfit > 0 ? '+' : ''}${hourData.avgProfit.toFixed(2)}%
                        </td>
                        <td style="padding: 10px; color: #888; font-size: 0.85rem;">${hourData.mostCommonRoute}</td>
                    </tr>
                `;
            });

            tbody.innerHTML = html;
        }

        /**
         * Update Status Dashboard
         */
        function updateStatusDashboard(data) {
            // Update cycles
            document.getElementById('crossExScanCycles').textContent = data.cycles || 0;

            // Update data collected
            const maxStorage = 50000;
            const collected = data.totalOpportunities || 0;
            const storagePercent = ((collected / maxStorage) * 100).toFixed(1);
            document.getElementById('crossExOppsFound').textContent = `${collected.toLocaleString()} / ${maxStorage.toLocaleString()}`;
            document.getElementById('crossExStoragePercent').textContent = `${storagePercent}%`;

            // Update running time
            if (data.startTime) {
                const elapsed = Date.now() - data.startTime;
                const minutes = Math.floor(elapsed / 60000);
                const seconds = Math.floor((elapsed % 60000) / 1000);
                document.getElementById('crossExRunTime').textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
            }

            // Update best opportunity
            if (data.routes && Object.keys(data.routes).length > 0) {
                const bestRoute = Object.values(data.routes)
                    .sort((a, b) => b.bestProfit - a.bestProfit)[0];
                document.getElementById('crossExBestOpp').textContent =
                    `${bestRoute.asset}: ${bestRoute.buyExchange}‚Üí${bestRoute.sellExchange} @ ${bestRoute.bestProfit > 0 ? '+' : ''}${bestRoute.bestProfit.toFixed(2)}%`;
            }
        }

        // ============================================================================
        // PAGE INITIALIZATION
        // ============================================================================

        /**
         * Initialize test scan on page load
         */
        document.addEventListener('DOMContentLoaded', function() {
            // Populate test scan asset selector
            populateTestScanAssets();
            console.log('‚úì Test scan asset selector populated with', allAssetPairs.length, 'assets');

            // Load existing scan data and populate tables
            const data = getCrossExScanData();
            if (data && data.totalOpportunities > 0) {
                console.log(`üìä Loading existing scan data: ${data.totalOpportunities.toLocaleString()} opportunities from ${data.cycles} cycles`);
                populateAllTables();
            } else {
                console.log('‚ÑπÔ∏è No existing scan data found. Click "Start Test Scan" to begin.');
            }
        });

        // End of Test Scan Functionality
    </script>
</body>
</html>